process Rec = 
{
  untracked PSet maxEvents = {untracked int32 input = 10}

  untracked PSet ReleaseValidation = 
  {
    untracked uint32 totalNumberOfEvents = 10000
    untracked uint32 eventsPerJob        = 250
    untracked string primaryDatasetName  = 'RelValPGunValidation'
  }
  untracked PSet configurationMetadata = 
  {
    untracked string version = "$Revision: 1.8 $"
    untracked string name = "$Source: /cvs_server/repositories/CMSSW/CMSSW/Validation/GlobalHits/test/PGunValidation.cfg,v $"
    untracked string annotation = "RelVal PGunValidation"
  }

  include "Configuration/ReleaseValidation/data/Services.cff"
  include "Configuration/StandardSequences/data/FakeConditions.cff"
  #include "Configuration/StandardSequences/data/FrontierConditions.cff"
  #include "FWCore/MessageService/data/MessageLogger.cfi"
  #include "Validation/GlobalHits/data/MessageLogger.cfi"
  include "DQMServices/Components/data/MessageLogger.cfi"
  service = LoadAllDictionaries {}
  
  untracked PSet options = 
  {
    include "FWCore/Framework/test/cmsExceptionsFatalOption.cff"
    untracked bool wantSummary = true
    untracked bool makeTriggerResults = true 
  }

  include "Validation/GlobalHits/data/FlatRandomEGunSource.cfi"
  replace maxEvents.input = 10
  replace FlatRandomEGunSource.PGunParameters.MinE = 9.99
  replace FlatRandomEGunSource.PGunParameters.MaxE = 100.01
  replace FlatRandomEGunSource.Verbosity = 0

  include "Configuration/StandardSequences/data/Generator.cff"   
  include "Configuration/StandardSequences/data/Reconstruction.cff"
  include "Configuration/StandardSequences/data/Simulation.cff"
  include "Configuration/StandardSequences/data/MixingNoPileUp.cff" 
  include "Configuration/StandardSequences/data/VtxSmearedGauss.cff" 
  include "Configuration/StandardSequences/data/L1Emulator.cff"
  //include "Validation/GlobalHits/data/globalhits.cfi"
  //include "Validation/GlobalDigis/data/globaldigis.cfi"
  //include "Validation/GlobalRecHits/data/globalrechits.cfi"
  //include "Validation/GlobalHits/data/globalhits_tester.cff"
  include "Validation/GlobalHits/data/globalhits_analyze.cff"
  include "Validation/GlobalDigis/data/globaldigis_analyze.cfi"
  include "Validation/GlobalRecHits/data/globalrechits_analyze.cfi"
  //include "Validation/GlobalHits/data/globalhits_prodhist.cfi"
  include "DQMServices/Components/data/MEtoROOTConverter.cfi"

  path p0 = {pgen} # generator information
  path p1 = {psim} # simulation
  path p2 = {pdigi} # digitization
  path p3 = {reconstruction_plusRS_plus_GSF} # reconstruction
  //path p4 = {L1Emulator,
  //           globalhits,globalhitsanalyze,globalhitsprodhist,
  //           globaldigis,globaldigisanalyze,
  //           globalrechits,globalrechitsanalyze,MEtoROOTConverter}
  //path p4 = {L1Emulator,
  //           globalhits,globalhitsanalyze,
  //           globaldigis,globaldigisanalyze,
  //           globalrechits,globalrechitsanalyze,MEtoROOTConverter}
  path p4 = {L1Emulator,globalhitsanalyze,globaldigisanalyze,
  	     globalrechitsanalyze,MEtoROOTConverter}
  //path p4 = {L1Emulator,globalhitsanalyze,MEtoROOTConverter}
  //path p4 = {globalhitstest}
  //path p4 = {globalhitstest,MEtoROOTConverter}

  include "Configuration/EventContent/data/EventContent.cff"

  module FEVT = PoolOutputModule 
  { 
    using FEVTSIMEventContent
    untracked string fileName = "PGunValidation.root"
    untracked PSet dataset =
    {	
      untracked string dataTier = "GEN-SIM-DIGI-RECO"
    }
  }
  replace FEVT.outputCommands += {
    "keep *_globalhits_*_*",
    "keep *_globaldigis_*_*",
    "keep *_globalrechits_*_*",
    "keep *_globalhitsprodhist_*_*",
    "keep *_MEtoROOTConverter_*_*"
  }

  endpath outpath = {FEVT}

  schedule = {p0,p1,p2,p3,p4,outpath}
  //schedule = {p4,outpath}
}
